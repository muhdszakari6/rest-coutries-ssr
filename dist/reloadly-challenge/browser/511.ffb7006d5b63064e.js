(self.webpackChunkreloadly_challenge=self.webpackChunkreloadly_challenge||[]).push([[511],{9511:(U,L,r)=>{"use strict";r.r(L),r.d(L,{CountriesModule:()=>ot});var m=r(4035),u=r(5620);const h=(0,u.PH)("Get Countries",(0,u.Ky)()),n=(0,u.PH)("Get Countries Success",(0,u.Ky)()),c=(0,u.PH)("Get Countries Failure",(0,u.Ky)()),Z=(0,u.Lq)({countries:[],error:"",loading:!1},(0,u.on)(h,e=>Object.assign(Object.assign({},e),{loading:!0})),(0,u.on)(n,(e,i)=>Object.assign(Object.assign({},e),{loading:!1,countries:i.countries,error:""})),(0,u.on)(c,(e,i)=>Object.assign(Object.assign({},e),{loading:!1,error:i.error,countries:[]}))),s=(0,u.ZF)("countries"),l=(0,u.P1)(s,e=>e.countries),A=(0,u.P1)(s,e=>e.loading),M=(0,u.P1)(s,e=>e.error);var y=r(4968),E=r(4004),v=r(9808),t=r(5e3),J=r(7322),I=r(3075),g=r(5245),T=r(8833),F=r(4107),P=r(508),j=r(6931),N=r(1522);const B=r(6839);let x=(()=>{class e{constructor(o){this.platformId=o}ngOnInit(){(0,v.NF)(this.platformId)&&this.observeImagesWithLozad()}observeImagesWithLozad(){B().observe()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(t.Lbi))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-country-card"]],inputs:{country:"country"},decls:20,vars:9,consts:[["data-test","country-link",1,"link",3,"routerLink"],[1,"card"],["data-placeholder-background","grey","width","250","alt","",1,"lozad",3,"alt"],[1,"card-details"],["data-test","country-name"],["data-test","country-population"],["data-test","country-region"],["data-test","country-capital"]],template:function(o,a){1&o&&(t.TgZ(0,"a",0)(1,"div",1),t._UZ(2,"img",2),t.TgZ(3,"div",3)(4,"h2",4),t._uU(5),t.qZA(),t.TgZ(6,"div")(7,"p"),t._uU(8,"Population: "),t.TgZ(9,"span",5),t._uU(10),t.ALo(11,"number"),t.qZA()(),t.TgZ(12,"p"),t._uU(13,"Region: "),t.TgZ(14,"span",6),t._uU(15),t.qZA()(),t.TgZ(16,"p"),t._uU(17,"Capital: "),t.TgZ(18,"span",7),t._uU(19),t.qZA()()()()()()),2&o&&(t.Q6J("routerLink",null==a.country||null==a.country.name?null:a.country.name.common),t.xp6(2),t.Q6J("alt",null==a.country||null==a.country.name?null:a.country.name.common),t.uIk("data-src",null==a.country||null==a.country.flags?null:a.country.flags.svg),t.xp6(3),t.Oqu(null==a.country||null==a.country.name?null:a.country.name.common),t.xp6(5),t.hij(" ",t.lcZ(11,7,null==a.country?null:a.country.population)," "),t.xp6(5),t.hij(" ",null==a.country?null:a.country.region," "),t.xp6(4),t.hij(" ",null==a.country?null:a.country.capital," "))},directives:[m.yS],pipes:[v.JJ],styles:[""],changeDetection:0}),e})();var H=r(7423),Y=r(7238);function z(e,i){if(1&e&&(t.TgZ(0,"mat-option",7),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o),t.xp6(1),t.Oqu(o)}}function D(e,i){1&e&&t._UZ(0,"app-page-loader")}function k(e,i){1&e&&t._UZ(0,"app-error-state",14),2&e&&t.Q6J("msg",i.ngIf)}function W(e,i){1&e&&t._UZ(0,"app-country-card",15),2&e&&t.Q6J("country",i.$implicit)}function G(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){return t.CHM(o),t.oxw(2).onScrollToTop()}),t.TgZ(1,"mat-icon"),t._uU(2,"expand_less"),t.qZA()()}}function V(e,i){if(1&e&&(t.ynx(0),t.YNc(1,k,1,1,"app-error-state",10),t.ALo(2,"async"),t.TgZ(3,"div",11),t.YNc(4,W,1,1,"app-country-card",12),t.ALo(5,"async"),t.qZA(),t.YNc(6,G,3,0,"button",13),t.ALo(7,"async"),t.BQk()),2&e){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",t.lcZ(2,4,o.error$)),t.xp6(3),t.Q6J("ngForOf",t.lcZ(5,6,o.countries$))("ngForTrackBy",o.trackCountry),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,8,o.showScroll$))}}const X=[{path:":name",loadChildren:()=>r.e(686).then(r.bind(r,6686)).then(e=>e.CountryModule)},{path:"",component:(()=>{class e{constructor(o,a,C){this.store=o,this.document=a,this.viewport=C,this.countries$=this.store.select(l),this.loading$=this.store.select(A),this.error$=this.store.select(M),this.regions=["Africa","Americas","Asia","Europe","Oceania"],this.searchValue="",this.showScroll$=(0,y.R)(this.document,"scroll").pipe((0,E.U)(()=>{var f;return(null===(f=this.viewport.getScrollPosition())||void 0===f?void 0:f[1])>0})),this.store.dispatch(h({payload:{type:"",query:""}}))}applyFilter(o){this.store.dispatch(h(""===o?{payload:{type:"",query:""}}:{payload:{type:"search",query:o.toLowerCase()}})),this.selectedRegion=""}regionChanged(o){this.store.dispatch(h(""==o?{payload:{type:"",query:""}}:{payload:{type:"filter",query:o}})),this.searchValue=""}trackCountry(o,a){return a.name.common}onScrollToTop(){this.viewport.scrollToPosition([0,0])}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(u.yh),t.Y36(v.K0),t.Y36(v.EM))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-countries"]],decls:15,vars:10,consts:[[1,"search-section","form-input"],["appearance","outline","ngDefaultControl","",1,"search-input"],["matPrefix","",1,"search-icon"],["data-test","country-search","type","text","matInput","","name","search","placeholder","Search for a country..",3,"ngModel","ngModelChange","keyup"],["input",""],["appearance","outline",1,"select-input"],["data-test","country-filter","placeholder","Filter by Region",3,"ngModel","ngModelChange","selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"msg",4,"ngIf"],[1,"countries-grid"],[3,"country",4,"ngFor","ngForOf","ngForTrackBy"],["matTooltip","Scroll to top","class","scroll-up","mat-fab","",3,"click",4,"ngIf"],[3,"msg"],[3,"country"],["matTooltip","Scroll to top","mat-fab","",1,"scroll-up",3,"click"]],template:function(o,a){if(1&o){const C=t.EpF();t.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-icon",2),t._uU(3,"search"),t.qZA(),t.TgZ(4,"input",3,4),t.NdJ("ngModelChange",function(p){return a.searchValue=p})("keyup",function(){t.CHM(C);const p=t.MAs(5);return a.applyFilter(p.value)}),t.qZA()(),t.TgZ(6,"mat-form-field",5)(7,"mat-select",6),t.NdJ("ngModelChange",function(p){return a.selectedRegion=p})("selectionChange",function(p){return a.regionChanged(p.value)}),t.TgZ(8,"mat-option",7),t._uU(9,"All"),t.qZA(),t.YNc(10,z,2,2,"mat-option",8),t.qZA()()(),t.YNc(11,D,1,0,"app-page-loader",9),t.ALo(12,"async"),t.YNc(13,V,8,10,"ng-container",9),t.ALo(14,"async")}2&o&&(t.xp6(4),t.Q6J("ngModel",a.searchValue),t.xp6(3),t.Q6J("ngModel",a.selectedRegion),t.xp6(1),t.Q6J("value",""),t.xp6(2),t.Q6J("ngForOf",a.regions),t.xp6(1),t.Q6J("ngIf",t.lcZ(12,6,a.loading$)),t.xp6(2),t.Q6J("ngIf",!t.lcZ(14,8,a.loading$)))},directives:[J.KE,I.Fj,g.Hw,J.qo,T.Nt,I.JJ,I.On,F.gD,P.ey,v.sg,v.O5,j.f,N.R,x,H.lW,Y.gM],pipes:[v.Ov],styles:[""]}),e})()}];let _=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[m.Bz.forChild(X)],m.Bz]}),e})();var w=r(5223),R=r(6642),q=r(3900),S=r(9646),$=r(262),tt=r(158);let et=(()=>{class e{constructor(o,a){this.actions$=o,this.countriesService=a,this.cache=new Map,this.countries$=(0,R.GW)(()=>this.actions$.pipe((0,R.l4)(h),(0,q.w)(C=>{var f,p,K;const O=JSON.stringify(C);return"search"===C.payload.type?this.cache.has(O)?(0,S.of)(n({countries:null!==(f=this.cache.get(O))&&void 0!==f?f:[]})):this.countriesService.searchCountries(C.payload.query).pipe((0,E.U)(b=>this.mapResponse(b,O)),(0,$.K)(b=>(0,S.of)(c({error:b})))):"filter"===C.payload.type?this.cache.has(O)?(0,S.of)(n({countries:null!==(p=this.cache.get(O))&&void 0!==p?p:[]})):this.countriesService.filterByRegion(C.payload.query).pipe((0,E.U)(b=>this.mapResponse(b,O)),(0,$.K)(b=>(0,S.of)(c({error:b})))):this.cache.has(O)?(0,S.of)(n({countries:null!==(K=this.cache.get(O))&&void 0!==K?K:[]})):this.countriesService.getCountries().pipe((0,E.U)(b=>this.mapResponse(b,O)),(0,$.K)(b=>(0,S.of)(c({error:b}))))}))),this.mapResponse=(C,f)=>{let p=nt(C);return this.cache.set(f,p),n({countries:p})}}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(R.eX),t.LFG(tt.K))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();const nt=e=>e.sort((i,o)=>i.name.common>o.name.common?1:o.name.common>i.name.common?-1:0);let ot=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[_,w.m,u.Aw.forFeature("countries",Z),R.sQ.forFeature([et])]]}),e})()},158:(U,L,r)=>{"use strict";r.d(L,{K:()=>c});var m=r(262),u=r(2843),h=r(5e3),n=r(520);let c=(()=>{class d{constructor(s){this.http=s}getCountries(){return this.http.get("/all").pipe((0,m.K)(s=>this.errorHandler(s)))}searchCountries(s){return this.http.get(`/name/${s}`).pipe((0,m.K)(l=>this.errorHandler(l)))}getCountryByFullText(s){return this.http.get(`/name/${s}?fullText=true`).pipe((0,m.K)(l=>this.errorHandler(l)))}getBorderCountries(s){return this.http.get(`/alpha?codes=${null==s?void 0:s.join(",")}`).pipe((0,m.K)(l=>this.errorHandler(l)))}filterByRegion(s){return this.http.get(`/region/${s}`).pipe((0,m.K)(l=>this.errorHandler(l)))}errorHandler(s){var l;let A;return A=s.error instanceof ErrorEvent?`An error occurred: ${null===(l=s.error)||void 0===l?void 0:l.message}`:`${s.statusText}`,console.error(s),(0,u._)(()=>new Error(A))}}return d.\u0275fac=function(s){return new(s||d)(h.LFG(n.eN))},d.\u0275prov=h.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},6839:function(U){U.exports=function(){"use strict";var L="undefined"!=typeof document&&document.documentMode,r={rootMargin:"0px",threshold:0,load:function(n){if("picture"===n.nodeName.toLowerCase()){var c=n.querySelector("img"),d=!1;null===c&&(c=document.createElement("img"),d=!0),L&&n.getAttribute("data-iesrc")&&(c.src=n.getAttribute("data-iesrc")),n.getAttribute("data-alt")&&(c.alt=n.getAttribute("data-alt")),d&&n.append(c)}if("video"===n.nodeName.toLowerCase()&&!n.getAttribute("data-src")&&n.children){for(var Z=n.children,s=void 0,l=0;l<=Z.length-1;l++)(s=Z[l].getAttribute("data-src"))&&(Z[l].src=s);n.load()}n.getAttribute("data-poster")&&(n.poster=n.getAttribute("data-poster")),n.getAttribute("data-src")&&(n.src=n.getAttribute("data-src")),n.getAttribute("data-srcset")&&n.setAttribute("srcset",n.getAttribute("data-srcset"));var A=",";if(n.getAttribute("data-background-delimiter")&&(A=n.getAttribute("data-background-delimiter")),n.getAttribute("data-background-image"))n.style.backgroundImage="url('"+n.getAttribute("data-background-image").split(A).join("'),url('")+"')";else if(n.getAttribute("data-background-image-set")){var M=n.getAttribute("data-background-image-set").split(A),y=M[0].substr(0,M[0].indexOf(" "))||M[0];y=-1===y.indexOf("url(")?"url("+y+")":y,1===M.length?n.style.backgroundImage=y:n.setAttribute("style",(n.getAttribute("style")||"")+"background-image: "+y+"; background-image: -webkit-image-set("+M+"); background-image: image-set("+M+")")}n.getAttribute("data-toggle-class")&&n.classList.toggle(n.getAttribute("data-toggle-class"))},loaded:function(){}};function m(n){n.setAttribute("data-loaded",!0)}var u=function(n){return"true"===n.getAttribute("data-loaded")},h=function(n){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document;return n instanceof Element?[n]:n instanceof NodeList?n:c.querySelectorAll(n)};return function(){var n,c,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:".lozad",s=Object.assign({},r,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}),l=s.root,y=s.load,E=s.loaded,v=void 0;"undefined"!=typeof window&&window.IntersectionObserver&&(v=new IntersectionObserver((n=y,c=E,function(g,T){g.forEach(function(F){(0<F.intersectionRatio||F.isIntersecting)&&(T.unobserve(F.target),u(F.target)||(n(F.target),m(F.target),c(F.target)))})}),{root:l,rootMargin:s.rootMargin,threshold:s.threshold}));for(var t,J=h(d,l),I=0;I<J.length;I++)(t=J[I]).getAttribute("data-placeholder-background")&&(t.style.background=t.getAttribute("data-placeholder-background"));return{observe:function(){for(var g=h(d,l),T=0;T<g.length;T++)u(g[T])||(v?v.observe(g[T]):(y(g[T]),m(g[T]),E(g[T])))},triggerLoad:function(g){u(g)||(y(g),m(g),E(g))},observer:v}}}()}}]);